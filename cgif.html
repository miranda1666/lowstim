<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Notion GIF Player</title>

  <style>
    :root{
      --page:#ffffff;
      --card:#fffdf7;
      --bar:#e9dfd1;
      --barText:#3a3226;

      --stroke:rgba(80,60,20,.08);
      --shadow:0 18px 60px rgba(40,30,10,.10);

      --radius:22px;
    }

    body{
      margin:0;
      padding:20px;
      background:var(--page);
      font-family:system-ui, sans-serif;
      display:flex;
      justify-content:center;
    }

    .player{
      width:min(700px,95vw);
      border-radius:var(--radius);
      overflow:hidden;
      background:var(--card);
      box-shadow:var(--shadow);
      border:1px solid var(--stroke);
    }

    /* GIF area */
    .media{
      position:relative;
      width:100%;
      aspect-ratio:16/9;
      background:#f4efe6;
    }

    .media img,
    .media canvas{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    canvas{
      display:none;
    }

    /* Date overlay */
    .stamp{
      position:absolute;
      left:14px;
      bottom:14px;
      padding:8px 10px;
      border-radius:14px;
      background:rgba(0,0,0,.15);
      color:white;
      font-weight:600;
      font-size:13px;
      line-height:1.2;
      backdrop-filter:blur(6px);
    }

    /* Control bar */
    .bar{
      display:flex;
      align-items:center;
      gap:12px;
      padding:14px;
      background:var(--bar);
    }

    .btn{
      width:40px;
      height:40px;
      border-radius:999px;
      border:1px solid rgba(0,0,0,.15);
      background:rgba(255,255,255,.65);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .btn svg{
      width:18px;
      height:18px;
      fill:var(--barText);
    }

    .title{
      flex:1;
      font-weight:650;
      color:var(--barText);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* Slider */
    input[type="range"]{
      width:200px;
      max-width:30vw;
    }

    /* Customize panel */
    details{
      padding:12px 14px;
      border-top:1px solid rgba(0,0,0,.08);
      background:rgba(0,0,0,.02);
    }

    textarea,input{
      width:100%;
      padding:8px;
      border-radius:10px;
      border:1px solid rgba(0,0,0,.15);
      margin-top:6px;
      font-size:13px;
      box-sizing:border-box;
    }

    .miniBtn{
      margin-top:8px;
      padding:8px 12px;
      border-radius:10px;
      border:1px solid rgba(0,0,0,.15);
      background:white;
      cursor:pointer;
      font-weight:650;
    }
  </style>
</head>

<body>
<div class="player">

  <!-- GIF Display -->
  <div class="media">
    <img id="gifImg" />
    <canvas id="freezeCanvas"></canvas>

    <div class="stamp">
      <div id="stampDate"></div>
      <div id="stampTime"></div>
    </div>
  </div>

  <!-- Controls -->
  <div class="bar">
    <button class="btn" id="shuffleBtn" title="Shuffle">
      <svg viewBox="0 0 24 24"><path d="M17 3h4v4h-2V6.4l-4.3 4.3-1.4-1.4L17.6 5H17V3z"/></svg>
    </button>

    <button class="btn" id="prevBtn" title="Previous">
      <svg viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6 10 6V6z"/></svg>
    </button>

    <button class="btn" id="playBtn" title="Play/Pause">
      <svg id="pauseIcon" viewBox="0 0 24 24"><path d="M6 5h4v14H6zm8 0h4v14h-4z"/></svg>
      <svg id="playIcon" viewBox="0 0 24 24" style="display:none;"><path d="M8 5v14l11-7z"/></svg>
    </button>

    <button class="btn" id="nextBtn" title="Next">
      <svg viewBox="0 0 24 24"><path d="M16 6h2v12h-2zM5 18l10-6L5 6z"/></svg>
    </button>

    <div class="title" id="trackTitle">Tenor GIF Player</div>

    <input id="progress" type="range" min="0" max="1000" value="0" />
  </div>

  <!-- Customize -->
  <details>
    <summary><b>Customize GIF List</b></summary>

    <label>Add GIF URL</label>
    <input id="gifUrlInput" placeholder="https://...gif" />
    <button class="miniBtn" id="addGifBtn">Add GIF</button>

    <label style="margin-top:10px;">GIF List (one per line)</label>
    <textarea id="gifListBox"></textarea>
    <button class="miniBtn" id="applyListBtn">Apply List</button>
  </details>

</div>

<script>
/* âœ… Default Tenor GIF */
const DEFAULT_GIFS = [
  { title: "Tenor Default", url: "https://tenor.com/Jt3l.gif" }
];

/* Local isolated storage */
const STORAGE_KEY = "gif_player_widget:" + location.pathname;

let state = {
  gifs: DEFAULT_GIFS,
  index: 0,
  playing: true,
  shuffle: false
};

const saved = localStorage.getItem(STORAGE_KEY);
if(saved){
  state = JSON.parse(saved);
}

/* Elements */
const gifImg = document.getElementById("gifImg");
const canvas = document.getElementById("freezeCanvas");
const ctx = canvas.getContext("2d");

const playBtn = document.getElementById("playBtn");
const playIcon = document.getElementById("playIcon");
const pauseIcon = document.getElementById("pauseIcon");

const gifUrlInput = document.getElementById("gifUrlInput");
const gifListBox = document.getElementById("gifListBox");

/* Save */
function save(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}

/* Load GIF */
function showGif(){
  const cur = state.gifs[state.index];
  gifImg.src = cur.url + "?v=" + Date.now();
  document.getElementById("trackTitle").textContent = cur.title;

  gifListBox.value = state.gifs.map(g=>g.url).join("\n");

  gifImg.style.display="block";
  canvas.style.display="none";
}

/* Freeze */
function freeze(){
  canvas.width = gifImg.clientWidth;
  canvas.height = gifImg.clientHeight;
  ctx.drawImage(gifImg,0,0,canvas.width,canvas.height);

  gifImg.style.display="none";
  canvas.style.display="block";
}

/* Play/Pause */
function togglePlay(){
  state.playing = !state.playing;
  save();

  if(state.playing){
    playIcon.style.display="none";
    pauseIcon.style.display="block";
    showGif();
  }else{
    pauseIcon.style.display="none";
    playIcon.style.display="block";
    freeze();
  }
}

/* Navigation */
function nextGif(){
  if(state.shuffle){
    state.index = Math.floor(Math.random()*state.gifs.length);
  }else{
    state.index = (state.index+1)%state.gifs.length;
  }
  save();
  showGif();
}

function prevGif(){
  state.index = (state.index-1+state.gifs.length)%state.gifs.length;
  save();
  showGif();
}

/* Add GIF */
document.getElementById("addGifBtn").onclick = ()=>{
  const url = gifUrlInput.value.trim();
  if(!url) return;

  state.gifs.push({ title:"GIF "+state.gifs.length, url });
  state.index = state.gifs.length-1;
  gifUrlInput.value="";
  save();
  showGif();
};

/* Apply list */
document.getElementById("applyListBtn").onclick = ()=>{
  const urls = gifListBox.value.split("\n").map(x=>x.trim()).filter(Boolean);
  state.gifs = urls.map((u,i)=>({title:"GIF "+(i+1),url:u}));
  state.index=0;
  save();
  showGif();
};

/* Buttons */
document.getElementById("nextBtn").onclick = nextGif;
document.getElementById("prevBtn").onclick = prevGif;
document.getElementById("shuffleBtn").onclick = ()=>{
  state.shuffle=!state.shuffle;
  save();
};
playBtn.onclick = togglePlay;

/* Timestamp */
function updateStamp(){
  const d = new Date();
  document.getElementById("stampDate").textContent =
    d.toLocaleDateString(undefined,{weekday:"long",day:"numeric",month:"long",year:"numeric"});
  document.getElementById("stampTime").textContent =
    d.toLocaleTimeString(undefined,{hour:"2-digit",minute:"2-digit"});
}
setInterval(updateStamp,30000);
updateStamp();

/* Init */
showGif();
</script>

</body>
</html>
