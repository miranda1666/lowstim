<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Dosis:wght@500&family=MuseoModerno:wght@300;400&display=swap" rel="stylesheet">

  <style>
    :root {
      --calc-bg: #ffffff;
      --calc-text: #000000;

      --border: #d8ccc2;
      --shadow: #9f877e;

      --btn-bg: #ffffff;
      --btn-text: #000000;
      --btn-border: #9f877e;

      --accent-bg: #d8ccc2;
      --accent-text: #000000;

      --hover-bg: #d8ccc2;
      --hover-text: #000000;

      --special-bg: rgb(159,135,126);
      --special-text: #ffffff;

      --screen-bg: #ffffff;
      --screen-text: #9f877e;

      --danger-hover-bg: #000000;
      --danger-hover-text: #9f877e;
    }

    body {
      margin: 0 auto;
      text-align: center;
      font-size: 23px;
    }

    .button > .over {
      text-decoration: overline;
      display: inline-block;
      position: relative;
      top: 3px;
      left: -4px;
    }

    /* Theme panel */
    .theme-panel {
      display: inline-block;
      margin: 16px auto 8px;
      padding: 12px 14px;
      border: 2px solid var(--border);
      border-radius: 10px;
      background: #fff;
      font-family: monospace;
      text-align: left;
      min-width: 260px;
    }


    .theme-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 10px;
    }

    .theme-panel h3 {
      margin: 0;
      font-size: 18px;
    }


    #toggleTheme {
      font-family: monospace;
      padding: 6px 10px;
      border-radius: 8px;
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      cursor: pointer;
      font-size: 14px;
      white-space: nowrap;
    }
    #toggleTheme:hover {
      background: var(--hover-bg);
      color: var(--hover-text);
    }

    .theme-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px 14px;
      align-items: center;
    }
    .theme-row {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      align-items: center;
      font-size: 14px;
    }
    .theme-row input[type="color"] {
      width: 42px;
      height: 28px;
      padding: 0;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: #fff;
      cursor: pointer;
    }
    .theme-actions {
      margin-top: 10px;
      display: flex;
      gap: 10px;
      justify-content: space-between;
    }
    .theme-actions button {
      font-family: monospace;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      cursor: pointer;
    }
    .theme-actions button:hover {
      background: var(--hover-bg);
      color: var(--hover-text);
    }


    .theme-body[hidden] {
      display: none !important;
    }

    .calculator {
      display: inline-block;
      background: var(--calc-bg);
      margin: 1% 0;
      color: var(--calc-text);
      border: 3px solid var(--border);
      border-radius: 5px;
      box-shadow: 2px 2px 1px 0px var(--shadow);
      max-width: 240px;
      padding: 8px 0;
    }

    #screen {
      border: 3px solid var(--border);
      border-radius: 5px;
      width: 80%;
      height: 50px;
      margin: 5%;
      text-align: right;
      overflow: auto;
      overflow-wrap: break-word;
      font-size: 30px;
      font-family: monospace;
      background-color: var(--screen-bg);
      color: var(--screen-text);
    }

    .rows { margin: 5%; }

    /* Rows as 5-column grid */
    .calculator__row1,
    .calculator__row2,
    .calculator__row3,
    .calculator__row4,
    .calculator__row5 {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      align-items: center;
      font-family: monospace;
    }

    .calculator .button {
      font-size: x-large;
      width: 100%;
      min-height: 2.2em;
      margin: 0;
      border-radius: 15%;
      border: 0.08em solid var(--btn-border);
      font-family: monospace;
      background: var(--btn-bg);
      color: var(--btn-text);
      box-shadow: 0.03em 0.03em 0.01em 0px var(--shadow);
    }

    .calculator .accent {
      background: var(--accent-bg);
      color: var(--accent-text);
    }


    #clean, #rad, #deg {
      background: var(--special-bg);
      color: var(--special-text);
    }

    .calculator button:hover {
      background: var(--hover-bg);
      color: var(--hover-text);
      transform: scale(0.9);
      border-radius: 20%;
    }

    .calculator #clear:hover, #rad:hover, #deg:hover {
      background: var(--danger-hover-bg) !important;
      color: var(--danger-hover-text);
      transform: scale(0.9);
      border-radius: 20%;
    }

    .calculator button:focus { outline: none; }

    .button:active,
    .button-active {
      background: rgb(0, 0, 0);
      color: #ffffff;
      transform: scale(0.8);
    }


    .pos-l1 { grid-column: 1; }
    .pos-l2 { grid-column: 2; }
    .pos-r5 { grid-column: 5; }


    .pos-zero { grid-column: 3; }
    .pos-eq   { grid-column: 4; }
    .pos-plus { grid-column: 5; }
  </style>
</head>

<body>
  <div class="theme-panel" aria-label="Theme settings">

    <div class="theme-header">
      <h3>Theme</h3>
      <button id="toggleTheme" type="button" aria-expanded="true">Hide theme</button>
    </div>


    <div class="theme-body" id="themeBody">
      <div class="theme-grid">
        <div class="theme-row">
          <label for="tCalcBg">Calculator</label>
          <input id="tCalcBg" type="color" data-cssvar="--calc-bg" />
        </div>

        <div class="theme-row">
          <label for="tBorder">Border</label>
          <input id="tBorder" type="color" data-cssvar="--border" />
        </div>

        <div class="theme-row">
          <label for="tBtnBg">Buttons</label>
          <input id="tBtnBg" type="color" data-cssvar="--btn-bg" />
        </div>

        <div class="theme-row">
          <label for="tBtnText">Button text</label>
          <input id="tBtnText" type="color" data-cssvar="--btn-text" />
        </div>

        <div class="theme-row">
          <label for="tAccent">Accent</label>
          <input id="tAccent" type="color" data-cssvar="--accent-bg" />
        </div>

        <div class="theme-row">
          <label for="tScreenText">Screen text</label>
          <input id="tScreenText" type="color" data-cssvar="--screen-text" />
        </div>
      </div>

      <div class="theme-actions">
        <button id="resetTheme" type="button">Reset</button>
        <button id="randomTheme" type="button">Random</button>
      </div>
    </div>
  </div>

  <div id="main">
    <div class="calculator">
      <input type="text" id="screen">

      <div class="rows">
        <div class="calculator__row1">
          <button class="button accent pos-l1">(</button>
          <button class="button accent pos-l2">)</button>
          <button class="button pos-r5" id="clean">AC</button>
        </div>

        <div class="calculator__row2">
          <button class="button accent">x^</button>
          <button class="button">7</button>
          <button class="button">8</button>
          <button class="button">9</button>
          <button class="button accent">*</button>
        </div>

        <div class="calculator__row3">
          <button class="button accent">%</button>
          <button class="button">4</button>
          <button class="button">5</button>
          <button class="button">6</button>
          <button class="button accent">/</button>
        </div>

        <div class="calculator__row4">
          <button class="button accent">&radic;<span class="over"></span></button>
          <button class="button">1</button>
          <button class="button">2</button>
          <button class="button">3</button>
          <button class="button accent">-</button>
        </div>

        <div class="calculator__row5">
          <button class="button accent pos-l1">.</button>
          <button class="button pos-zero">0</button>
          <button class="button accent pos-eq">=</button>
          <button class="button accent pos-plus">+</button>
        </div>
      </div>
    </div>
  </div>

<script>
  var display = document.getElementById("screen");
  var buttons = document.getElementsByClassName("button");

  Array.prototype.forEach.call(buttons, function(button) {
    button.addEventListener("click", function() {
      if (button.textContent != "=" &&
          button.textContent != "AC" &&
          button.textContent != "*" &&
          button.textContent != "/" &&
          button.textContent != "√" &&
          button.textContent != "+" &&
          button.textContent != "%" &&
          button.textContent != "-" &&
          button.textContent != "sin" &&
          button.textContent != "cos" &&
          button.textContent != "tan" &&
          button.textContent != "log" &&
          button.textContent != "ln" &&
          button.textContent != "x^" &&
          button.textContent != "x!" &&
          button.textContent != "pi" &&
          button.textContent != "Rad" &&
          button.textContent != "Deg") {
        display.value += button.textContent;
      } else if (button.textContent === "=") {
        equals();
      } else if (button.textContent === "AC") {
        clear();
      } else if (button.textContent === "*") {
        multiply();
      } else if (button.textContent === "/") {
        divide();
      } else if (button.textContent === "+") {
        plus();
      } else if (button.textContent === "-") {
        Minus();
      } else if (button.textContent === "%") {
        percent();
      } else if (button.textContent === "pi") {
        pi();
      } else if (button.textContent === "√") {
        squareRoot();
      } else if (button.textContent === "sin") {
        sin();
      } else if (button.textContent === "cos") {
        cos();
      } else if (button.textContent === "tan") {
        tan();
      } else if (button.textContent === "log") {
        log();
      } else if (button.textContent === "ln") {
        ln();
      } else if (button.textContent === "x^") {
        exponent();
      } else if (button.textContent === "x!") {
        factorial();
      } else if (button.textContent === "Rad") {
        radians();
      } else if (button.textContent === "Deg") {
        degrees();
      }
    });
  });

  function syntaxError() {
    try { eval(display.value); }
    catch (e) { display.value = "Syntax Error"; }
  }

  function equals() {
    if ((display.value).indexOf("^") > -1) {
      var base = (display.value).slice(0, (display.value).indexOf("^"));
      var exponent = (display.value).slice((display.value).indexOf("^") + 1);
      display.value = eval("Math.pow(" + base + "," + exponent + ")");
    } else {
      display.value = eval(display.value);
      syntaxError();
    }
  }

  function clear() { display.value = ""; }
  function multiply() { display.value += "*"; }
  function divide() { display.value += "/"; }
  function plus() { display.value += "+"; }
  function Minus() { display.value += "-"; }

  function factorial() {
    var number = 1;
    if (display.value === 0) {
      display.value = "1";
    } else if (display.value < 0) {
      display.value = "undefined";
    } else {
      number = 1;
      for (var i = display.value; i > 0; i--) number *= i;
      display.value = number;
    }
  }

  function pi() { display.value = (display.value * Math.PI); }
  function squareRoot() { display.value = Math.sqrt(display.value); }
  function percent() { display.value = display.value / 100; }
  function sin() { display.value = Math.sin(display.value); }
  function cos() { display.value = Math.cos(display.value); }
  function tan() { display.value = Math.tan(display.value); }
  function log() { display.value = Math.log10(display.value); }
  function ln() { display.value = Math.log(display.value); }
  function exponent() { display.value += "^"; }
  function radians() { display.value = display.value * (Math.PI / 180); }
  function degrees() { display.value = display.value * (180 / Math.PI); }

  // Theme logic
  const themeInputs = document.querySelectorAll('[data-cssvar]');
  const rootStyle = document.documentElement.style;

  const defaults = {
    "--calc-bg": "#ffffff",
    "--border": "#d8ccc2",
    "--btn-bg": "#ffffff",
    "--btn-text": "#000000",
    "--accent-bg": "#d8ccc2",
    "--screen-text": "#9f877e"
  };

  function applyTheme(themeObj) {
    Object.keys(themeObj).forEach((cssVar) => {
      rootStyle.setProperty(cssVar, themeObj[cssVar]);
    });
  }

  function saveTheme(themeObj) {
    localStorage.setItem("calcTheme", JSON.stringify(themeObj));
  }

  function loadTheme() {
    try {
      const saved = JSON.parse(localStorage.getItem("calcTheme") || "null");
      return saved && typeof saved === "object" ? saved : null;
    } catch {
      return null;
    }
  }

  function syncPickers() {
    const saved = loadTheme() || defaults;
    themeInputs.forEach((input) => {
      const cssVar = input.getAttribute("data-cssvar");
      input.value = (saved[cssVar] || defaults[cssVar]).trim();
    });
  }

  const savedTheme = loadTheme();
  applyTheme(savedTheme || defaults);
  syncPickers();

  themeInputs.forEach((input) => {
    input.addEventListener("input", () => {
      const cssVar = input.getAttribute("data-cssvar");
      const next = loadTheme() || { ...defaults };
      next[cssVar] = input.value;
      applyTheme(next);
      saveTheme(next);
    });
  });

  document.getElementById("resetTheme").addEventListener("click", () => {
    applyTheme(defaults);
    saveTheme(defaults);
    syncPickers();
  });

  function randomHex() {
    return "#" + Math.floor(Math.random() * 16777215).toString(16).padStart(6, "0");
  }

  document.getElementById("randomTheme").addEventListener("click", () => {
    const next = {
      ...defaults,
      "--calc-bg": randomHex(),
      "--border": randomHex(),
      "--btn-bg": randomHex(),
      "--btn-text": randomHex(),
      "--accent-bg": randomHex(),
      "--screen-text": randomHex()
    };
    applyTheme(next);
    saveTheme(next);
    syncPickers();
  });


  const toggleBtn = document.getElementById("toggleTheme");
  const themeBody = document.getElementById("themeBody");
  const THEME_VIS_KEY = "calcThemePanelHidden";

  function setThemePanelHidden(hidden) {
    themeBody.hidden = hidden;
    toggleBtn.textContent = hidden ? "Show theme" : "Hide theme";
    toggleBtn.setAttribute("aria-expanded", String(!hidden));
    localStorage.setItem(THEME_VIS_KEY, hidden ? "1" : "0");
  }

  // initial state from storage
  const savedHidden = localStorage.getItem(THEME_VIS_KEY) === "1";
  setThemePanelHidden(savedHidden);

  toggleBtn.addEventListener("click", () => {
    setThemePanelHidden(!themeBody.hidden);
  });
</script>
</body>
</html>
