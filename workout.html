<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Workout Tracker + Planner</title>
  <meta name="description" content="Workout tracker & weekly planner." />
  <style>
    :root{
      --bg:#ffffff;
      --cream:#e6d8cc;
      --stone:#c9beb6;
      --text:#1f1f1f;
      --muted:#6b625c;
      --shadow: 0 10px 28px rgba(0,0,0,0.08);
      --shadow-soft: 0 4px 14px rgba(0,0,0,0.06);
      --radius:18px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      display:flex;
      min-height:100vh;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    .wrap{ width:100%; max-width:980px; }
    .topbar{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:14px;
      margin-bottom:14px;
    }
    .title{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .kicker{
      font-size:12px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--muted);
    }
    h1{
      margin:0;
      font-size:28px;
      line-height:1.1;
      font-weight:720;
      letter-spacing:-0.02em;
    }
    .sub{
      margin:0;
      font-size:13px;
      color:#5e564f;
      line-height:1.4;
      max-width:70ch;
    }
    .actions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .btn{
      appearance:none;
      border:1px solid var(--stone);
      background:var(--bg);
      color:var(--text);
      padding:9px 12px;
      border-radius:999px;
      font-size:12px;
      letter-spacing:.06em;
      text-transform:uppercase;
      cursor:pointer;
      box-shadow:var(--shadow-soft);
      transition: transform 160ms ease, box-shadow 160ms ease, background 160ms ease;
      user-select:none;
    }
    .btn:hover{
      transform:translateY(-1px);
      box-shadow:0 10px 18px rgba(0,0,0,0.08);
    }
    .btn.primary{ background:var(--cream); }
    .grid{
      display:grid;
      grid-template-columns: 1.15fr 0.85fr;
      gap:14px;
    }
    .card{
      background:var(--bg);
      border:1px solid var(--stone);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card-head{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:12px;
    }
    .card-title{
      margin:0;
      font-size:14px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .week-meta{
      font-size:12px;
      color:var(--muted);
      letter-spacing:.02em;
      white-space:nowrap;
    }

    /* Planner */
    .days{
      display:grid;
      grid-template-columns: repeat(7, minmax(0, 1fr));
      gap:10px;
    }
    .day{
      border:1px solid rgba(201,190,182,0.7);
      border-radius:16px;
      padding:10px;
      background: linear-gradient(180deg, rgba(230,216,204,0.22), rgba(255,255,255,0));
      min-height:148px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .day-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:6px;
    }
    .dow{
      font-size:12px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .date-pill{
      font-size:11px;
      color:var(--muted);
      border:1px solid rgba(201,190,182,0.8);
      border-radius:999px;
      padding:4px 8px;
      background:var(--bg);
      user-select:none;
    }
    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    label{
      font-size:11px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--muted);
    }
    input[type="text"], textarea{
      width:100%;
      border:1px solid rgba(201,190,182,0.9);
      border-radius:12px;
      padding:9px 10px;
      font-size:13px;
      background:var(--bg);
      outline:none;
    }
    textarea{ resize:none; min-height:54px; }
    input[type="text"]:focus, textarea:focus{
      box-shadow: 0 0 0 3px rgba(230,216,204,0.55);
      border-color: rgba(201,190,182,1);
    }

    .intensity{
      display:flex;
      gap:6px;
      flex-wrap:wrap;
    }
    .chip{
      appearance:none;
      border:1px solid var(--stone);
      background:var(--bg);
      color:var(--text);
      padding:7px 10px;
      border-radius:999px;
      font-size:12px;
      cursor:pointer;
      box-shadow:var(--shadow-soft);
      transition: transform 160ms ease, box-shadow 160ms ease, background 160ms ease;
      user-select:none;
    }
    .chip:hover{ transform:translateY(-1px); }
    .chip[data-active="true"]{
      background:var(--cream);
      box-shadow:0 10px 18px rgba(0,0,0,0.08);
      transform:translateY(-1px);
    }

    .mini-row{
      display:flex;
      gap:8px;
      align-items:center;
      justify-content:space-between;
    }
    .done{
      display:flex;
      gap:8px;
      align-items:center;
      font-size:12px;
      color:var(--muted);
      user-select:none;
    }
    .toggle{
      width:36px; height:22px; border-radius:999px;
      border:1px solid rgba(201,190,182,0.95);
      background:var(--bg);
      position:relative;
      cursor:pointer;
      box-shadow:var(--shadow-soft);
      transition: background 180ms ease;
      flex:0 0 auto;
    }
    .toggle::after{
      content:"";
      position:absolute;
      top:2px; left:2px;
      width:18px; height:18px;
      border-radius:999px;
      background:var(--stone);
      transition: transform 180ms ease, background 180ms ease;
    }
    .toggle[data-on="true"]{
      background: rgba(230,216,204,0.65);
    }
    .toggle[data-on="true"]::after{
      transform: translateX(14px);
      background: #b8aea7;
    }

    /* Summary */
    .stats{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
    }
    .stat{
      border:1px solid rgba(201,190,182,0.7);
      border-radius:16px;
      padding:12px;
      background: linear-gradient(180deg, rgba(230,216,204,0.22), rgba(255,255,255,0));
    }
    .stat-top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:6px;
    }
    .stat-label{
      font-size:12px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .stat-value{
      font-size:22px;
      font-weight:720;
      letter-spacing:-0.02em;
    }
    .bar{
      height:10px;
      border-radius:999px;
      background: rgba(201,190,182,0.35);
      overflow:hidden;
      border:1px solid rgba(201,190,182,0.55);
    }
    .bar > div{
      height:100%;
      width:0%;
      background: var(--stone);
      transition: width 240ms ease;
    }
    .hint{
      margin-top:8px;
      font-size:12px;
      color:#7a716a;
      line-height:1.4;
    }
    .list{
      margin:0;
      padding-left:18px;
      font-size:13px;
      color:#5e564f;
      line-height:1.45;
    }
    .list li{ margin:6px 0; }

    /* Responsive */
    @media (max-width: 980px){
      .grid{ grid-template-columns:1fr; }
      .days{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 520px){
      .days{ grid-template-columns:1fr; }
      h1{ font-size:24px; }
    }
  </style>
</head>

<body>
  <main class="wrap">
    <div class="topbar">
      <div class="title">
        <div class="kicker">Workout Tracker + Planner</div>
      </div>
      <div class="actions">
        <button id="prevWeek" class="btn" type="button">◀ Prev</button>
        <button id="nextWeek" class="btn" type="button">Next ▶</button>
        <button id="resetWeek" class="btn primary" type="button">Clear week</button>
      </div>
    </div>

    <div class="grid">
      <!-- Planner -->
      <section class="card" aria-label="Weekly planner">
        <div class="card-head">
          <h2 class="card-title">Weekly plan</h2>
          <div id="weekMeta" class="week-meta"></div>
        </div>

        <div id="days" class="days"></div>
      </section>

      <!-- Summary -->
      <aside class="card" aria-label="Summary">
        <div class="card-head">
          <h2 class="card-title">Summary</h2>
          <div class="week-meta">auto updates</div>
        </div>

        <div class="stats">
          <div class="stat">
            <div class="stat-top">
              <div class="stat-label">Workouts completed</div>
              <div id="completedVal" class="stat-value">0</div>
            </div>
            <div class="bar" aria-hidden="true"><div id="completedBar"></div></div>
            <div class="hint">Completion is based on your “Done” toggles.</div>
          </div>

          <div class="stat">
            <div class="stat-top">
              <div class="stat-label">Planned sessions</div>
              <div id="plannedVal" class="stat-value">0</div>
            </div>
            <div class="bar" aria-hidden="true"><div id="plannedBar"></div></div>
            <div class="hint">A day counts as planned if it has a workout name.</div>
          </div>

          <div class="stat">
            <div class="stat-top">
              <div class="stat-label">Intensity mix</div>
              <div id="mixVal" class="stat-value">—</div>
            </div>
            <ul id="mixList" class="list">
              <li>Light: 0</li>
              <li>Moderate: 0</li>
              <li>Intense: 0</li>
            </ul>
            <div class="hint">Counts only planned sessions (workout name filled).</div>
          </div>

          <div class="stat">
            <div class="stat-top">
              <div class="stat-label">Today’s plan</div>
              <div id="todayBadge" class="date-pill">—</div>
            </div>
            <div id="todaySummary" class="hint">No plan set for today yet.</div>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <script>
    window.addEventListener("DOMContentLoaded", () => {
      // --- Date helpers (Monday-start week) ---
      const MS_DAY = 86400000;
      const dowNames = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];

      function startOfWeek(date){
        // Monday = 1; Sunday = 0
        const d = new Date(date.getFullYear(), date.getMonth(), date.getDate());
        const js = d.getDay(); // 0..6 Sun..Sat
        const mondayOffset = (js === 0) ? -6 : (1 - js);
        d.setDate(d.getDate() + mondayOffset);
        d.setHours(0,0,0,0);
        return d;
      }
      function fmtShort(d){
        const m = d.toLocaleString(undefined, { month:"short" });
        return `${d.getDate()} ${m}`;
      }
      function fmtRange(weekStart){
        const end = new Date(weekStart.getTime() + 6*MS_DAY);
        const y = weekStart.getFullYear();
        return `${fmtShort(weekStart)} – ${fmtShort(end)} · ${y}`;
      }
      function isoKey(d){
        const y = d.getFullYear();
        const m = String(d.getMonth()+1).padStart(2,"0");
        const day = String(d.getDate()).padStart(2,"0");
        return `${y}-${m}-${day}`;
      }

      // --- Storage ---
      const STORAGE_PREFIX = "workout_planner_v1_";
      function weekStorageKey(weekStart){
        return STORAGE_PREFIX + isoKey(weekStart);
      }

      function defaultDay(){
        return { name:"", plan:"", intensity:"moderate", done:false };
      }

      function loadWeek(weekStart){
        const key = weekStorageKey(weekStart);
        const raw = localStorage.getItem(key);
        if(!raw){
          const obj = {};
          for(let i=0;i<7;i++){
            const d = new Date(weekStart.getTime() + i*MS_DAY);
            obj[isoKey(d)] = defaultDay();
          }
          return obj;
        }
        try{
          const parsed = JSON.parse(raw);
          // Ensure all 7 exist
          for(let i=0;i<7;i++){
            const d = new Date(weekStart.getTime() + i*MS_DAY);
            const k = isoKey(d);
            if(!parsed[k]) parsed[k] = defaultDay();
            parsed[k] = { ...defaultDay(), ...parsed[k] };
          }
          return parsed;
        }catch{
          localStorage.removeItem(key);
          return loadWeek(weekStart);
        }
      }

      function saveWeek(weekStart, data){
        localStorage.setItem(weekStorageKey(weekStart), JSON.stringify(data));
      }

      // --- UI elements ---
      const daysEl = document.getElementById("days");
      const weekMetaEl = document.getElementById("weekMeta");

      const completedVal = document.getElementById("completedVal");
      const plannedVal = document.getElementById("plannedVal");
      const completedBar = document.getElementById("completedBar");
      const plannedBar = document.getElementById("plannedBar");

      const mixVal = document.getElementById("mixVal");
      const mixList = document.getElementById("mixList");

      const todayBadge = document.getElementById("todayBadge");
      const todaySummary = document.getElementById("todaySummary");

      const prevBtn = document.getElementById("prevWeek");
      const nextBtn = document.getElementById("nextWeek");
      const resetBtn = document.getElementById("resetWeek");

      // --- App state ---
      let weekStart = startOfWeek(new Date());
      let weekData = loadWeek(weekStart);

      // --- Rendering ---
      function render(){
        weekMetaEl.textContent = fmtRange(weekStart);
        daysEl.innerHTML = "";

        for(let i=0;i<7;i++){
          const date = new Date(weekStart.getTime() + i*MS_DAY);
          const key = isoKey(date);
          const item = weekData[key] || defaultDay();

          const day = document.createElement("div");
          day.className = "day";

          // Header
          const head = document.createElement("div");
          head.className = "day-head";

          const dow = document.createElement("div");
          dow.className = "dow";
          dow.textContent = dowNames[i];

          const dp = document.createElement("div");
          dp.className = "date-pill";
          dp.textContent = fmtShort(date);

          head.appendChild(dow);
          head.appendChild(dp);
          day.appendChild(head);

          // Workout name
          const f1 = document.createElement("div");
          f1.className = "field";

          const l1 = document.createElement("label");
          l1.textContent = "Workout";
          const inp = document.createElement("input");
          inp.type = "text";
          inp.placeholder = "e.g. Glutes + Core";
          inp.value = item.name;

          inp.addEventListener("input", () => {
            weekData[key].name = inp.value;
            saveWeek(weekStart, weekData);
            updateSummary();
          });

          f1.appendChild(l1);
          f1.appendChild(inp);
          day.appendChild(f1);

          // Plan notes
          const f2 = document.createElement("div");
          f2.className = "field";

          const l2 = document.createElement("label");
          l2.textContent = "Plan";
          const ta = document.createElement("textarea");
          ta.placeholder = "2–4 bullets: exercises, sets, time, etc.";
          ta.value = item.plan;

          ta.addEventListener("input", () => {
            weekData[key].plan = ta.value;
            saveWeek(weekStart, weekData);
          });

          f2.appendChild(l2);
          f2.appendChild(ta);
          day.appendChild(f2);

          // Intensity chips
          const f3 = document.createElement("div");
          f3.className = "field";

          const l3 = document.createElement("label");
          l3.textContent = "Intensity";
          const chips = document.createElement("div");
          chips.className = "intensity";

          const options = [
            { id:"light", label:"Light" },
            { id:"moderate", label:"Moderate" },
            { id:"intense", label:"Intense" }
          ];

          options.forEach(opt => {
            const b = document.createElement("button");
            b.type = "button";
            b.className = "chip";
            b.textContent = opt.label;
            b.dataset.active = String(item.intensity === opt.id);

            b.addEventListener("click", () => {
              weekData[key].intensity = opt.id;
              // update chip visuals inside this day
              Array.from(chips.querySelectorAll(".chip")).forEach(x => x.dataset.active = "false");
              b.dataset.active = "true";
              saveWeek(weekStart, weekData);
              updateSummary();
            });

            chips.appendChild(b);
          });

          f3.appendChild(l3);
          f3.appendChild(chips);
          day.appendChild(f3);

          // Done toggle
          const mini = document.createElement("div");
          mini.className = "mini-row";

          const doneWrap = document.createElement("div");
          doneWrap.className = "done";
          doneWrap.textContent = "Done";

          const toggle = document.createElement("div");
          toggle.className = "toggle";
          toggle.dataset.on = String(!!item.done);

          toggle.addEventListener("click", () => {
            weekData[key].done = !weekData[key].done;
            toggle.dataset.on = String(weekData[key].done);
            saveWeek(weekStart, weekData);
            updateSummary();
          });

          mini.appendChild(doneWrap);
          mini.appendChild(toggle);
          day.appendChild(mini);

          daysEl.appendChild(day);
        }

        updateSummary();
      }

      function clampPct(x){ return Math.max(0, Math.min(100, x)); }

      function updateSummary(){
        const keys = Object.keys(weekData);

        const planned = keys.filter(k => (weekData[k].name || "").trim().length > 0);
        const completed = planned.filter(k => weekData[k].done);

        const plannedCount = planned.length;
        const completedCount = completed.length;

        plannedVal.textContent = plannedCount;
        completedVal.textContent = completedCount;

        // Bars: planned out of 7, completed out of planned (or 7 if none planned)
        plannedBar.style.width = clampPct((plannedCount / 7) * 100) + "%";
        const denom = plannedCount > 0 ? plannedCount : 7;
        completedBar.style.width = clampPct((completedCount / denom) * 100) + "%";

        // Intensity mix (planned only)
        const mix = { light:0, moderate:0, intense:0 };
        planned.forEach(k => {
          const it = weekData[k].intensity || "moderate";
          if(mix[it] !== undefined) mix[it] += 1;
        });

        const mixText = plannedCount === 0 ? "—" : `${mix.light}/${mix.moderate}/${mix.intense}`;
        mixVal.textContent = mixText;
        mixList.innerHTML = `
          <li>Light: ${mix.light}</li>
          <li>Moderate: ${mix.moderate}</li>
          <li>Intense: ${mix.intense}</li>
        `;

        // Today summary
        const today = new Date();
        const todayKey = isoKey(today);
        todayBadge.textContent = fmtShort(today);

        const todayItem = weekData[todayKey];
        if(todayItem && (todayItem.name || "").trim()){
          const niceIntensity = (todayItem.intensity || "moderate").replace(/^\w/, c => c.toUpperCase());
          const done = todayItem.done ? "✅" : "○";
          todaySummary.textContent = `${done} ${todayItem.name} · ${niceIntensity}${todayItem.plan.trim() ? " · " + todayItem.plan.trim().split("\n")[0] : ""}`;
        }else{
          todaySummary.textContent = "No plan set for today yet.";
        }
      }

      // --- Week navigation ---
      prevBtn.addEventListener("click", () => {
        weekStart = new Date(weekStart.getTime() - 7*MS_DAY);
        weekData = loadWeek(weekStart);
        render();
      });
      nextBtn.addEventListener("click", () => {
        weekStart = new Date(weekStart.getTime() + 7*MS_DAY);
        weekData = loadWeek(weekStart);
        render();
      });
      resetBtn.addEventListener("click", () => {
        const key = weekStorageKey(weekStart);
        localStorage.removeItem(key);
        weekData = loadWeek(weekStart);
        render();
      });

      render();
    });
  </script>
</body>
</html>
